<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Hannah De los Santos" />

<meta name="date" content="2019-06-20" />

<title>Introduction to Using ECHO</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Introduction to Using ECHO</h1>
<h4 class="author"><em>Hannah De los Santos</em></h4>
<h4 class="date"><em>2019-06-20</em></h4>



<style type="text/css">

h1.title {
  text-align: center;
}
h4.author { 
  text-align: center;
}
h4.date { 
  text-align: center;
}
</style>
<p>The <em>echo.find</em> package provides a function (echo_find()) designed to find rhythms from expression data using extended harmonic oscillators. To read more about our inital work on this project and cite us, see <a href="https://dl.acm.org/citation.cfm?id=3107420&amp;CFID=1006798692&amp;CFTOKEN=88816139">Circadian Rhythms in Neurospora Exhibit Biologically Relevant Driven and Damped Harmonic Oscillations</a> by H. De los Santos et al. (2017) Further, for users who prefer an interface more than coding, as well as built-in visualizations, our GitHub repository can be found <a href="https://github.com/delosh653/ECHO">here</a>. There, you can find a shiny application for finding rhythms and automatically visualizing results, with features such as Venn diagrams, heat maps, gene expression plots (with or without replicates visualized), and parameter density graphs. A FAQ for possible user errors can also be found there.</p>
<p>In this vignette, we’ll walk through an example of how to use <em>echo.find</em>, and how to choose from the several different built-in methods of preprocessing.</p>
<div id="loading-and-examining-data" class="section level2">
<h2>Loading and Examining Data</h2>
<p>We’ll start by loading our library, which contains the echo_find() function. It also has an example dataframe, expressions, which we’ll be using throughout this vignette. Here we’ll look at the first few rows and columns of our dataset.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(echo.find)
<span class="kw">head</span>(expressions[,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>])</code></pre></div>
<pre><code>##   Gene.Name      CT2.1      CT2.2      CT2.3      CT4.1
## 1  Sample 1  1.6331179  1.4976053  1.5138102  1.3095535
## 2  Sample 2 -0.6303192 -0.6027464 -0.5105009 -0.5062033
## 3  Sample 3         NA -0.7802214 -0.7767950  0.2847617
## 4  Sample 4  0.4659923  0.4940659         NA  0.1018655
## 5  Sample 5  0.7026372  0.6405812  1.0235155  1.7199453
## 6  Sample 6  0.9261508  0.8858768  0.8035570         NA</code></pre>
<p>Note the data format: its first column first column has gene labels/names, and all other columns have numerical expression data. This expression data is ordered by time point then by replicate, and has evenly spaced time points. Any missing data has cells left blank. In order to use the echo_find() function, data must be in this format. Now, let’s look at one the data expressions, Sample 2. Here we plot each of the replicates in a different color, then plot the difference between them in gray.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)

tp &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">2</span>,<span class="dv">48</span>,<span class="dt">by=</span><span class="dv">2</span>) <span class="co"># our time points</span>
num_reps &lt;-<span class="st"> </span><span class="dv">3</span> <span class="co"># number of replicates</span>

samp &lt;-<span class="st"> </span><span class="dv">2</span> <span class="co"># sample we want to look at</span>
ex.df &lt;-<span class="st"> </span>expressions[samp,<span class="op">-</span><span class="dv">1</span>] <span class="co"># expression data for the first sample</span>

<span class="co"># our visualization data frame       </span>
ribbon.df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">matrix</span>(<span class="dt">ncol =</span> <span class="dv">3</span><span class="op">+</span>num_reps, <span class="dt">nrow =</span> <span class="kw">length</span>(tp)))
<span class="co"># assigning column names</span>
<span class="kw">colnames</span>(ribbon.df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Times&quot;</span>,<span class="st">&quot;Min&quot;</span>,<span class="st">&quot;Max&quot;</span>, 
                         <span class="kw">paste</span>(<span class="kw">rep</span>(<span class="st">&quot;Rep&quot;</span>,num_reps),<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span>num_reps), <span class="dt">sep=</span><span class="st">&quot;.&quot;</span>)) 
ribbon.df<span class="op">$</span>Times &lt;-<span class="st"> </span>tp
<span class="co"># getting min values of replicates</span>
ribbon.df<span class="op">$</span>Min &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="kw">seq</span>(<span class="dv">1</span>,<span class="kw">ncol</span>(ex.df), <span class="dt">by =</span> num_reps),
                        <span class="cf">function</span>(x) <span class="kw">min</span>(<span class="kw">unlist</span>(ex.df[,<span class="kw">c</span>(x<span class="op">:</span>(num_reps<span class="op">-</span><span class="dv">1</span><span class="op">+</span>x))]), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))
<span class="co"># getting max values of replicates</span>
ribbon.df<span class="op">$</span>Max &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="kw">seq</span>(<span class="dv">1</span>,<span class="kw">ncol</span>(ex.df), <span class="dt">by =</span> num_reps),
                        <span class="cf">function</span>(x) <span class="kw">max</span>(<span class="kw">unlist</span>(ex.df[,<span class="kw">c</span>(x<span class="op">:</span>(num_reps<span class="op">-</span><span class="dv">1</span><span class="op">+</span>x))]), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))
<span class="co"># assign each of the replicates to the visualization data frame</span>
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>num_reps){ 
  ribbon.df[,<span class="dv">3</span><span class="op">+</span>i] &lt;-<span class="st"> </span><span class="kw">t</span>(ex.df[,<span class="kw">seq</span>(i,<span class="kw">ncol</span>(ex.df),<span class="dt">by=</span>num_reps)])
}

<span class="co"># color names</span>
color_bar &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Rep.1&quot;</span>=<span class="st">&quot;red&quot;</span>,<span class="st">&quot;Rep.2&quot;</span>=<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;Rep.3&quot;</span>=<span class="st">&quot;green&quot;</span>)

<span class="co"># visualize, with shading for each row</span>
p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> ribbon.df,<span class="kw">aes</span>(<span class="dt">x=</span>Times))<span class="op">+</span><span class="st"> </span><span class="co"># declare the dataframe and main variables</span>
<span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Times, <span class="dt">ymax=</span>Max, <span class="dt">ymin=</span>Min, <span class="dt">colour=</span><span class="st">&quot;Original&quot;</span>),
              <span class="dt">fill =</span> <span class="st">&quot;gray&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>)<span class="op">+</span><span class="st"> </span><span class="co"># create shading</span>
<span class="st">  </span><span class="kw">ggtitle</span>(expressions[samp,<span class="dv">1</span>])<span class="op">+</span><span class="st"> </span><span class="co"># gene name is title</span>
<span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="st">&quot;&quot;</span>,<span class="dt">values=</span>color_bar)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="st">&quot;&quot;</span>,<span class="dt">values=</span>color_bar)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> .<span class="dv">5</span>),
        <span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,<span class="dt">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Hours&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Expression&quot;</span>) <span class="co">#Label for axes</span>
<span class="co"># add specific replicate lines </span>
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>num_reps){
  p &lt;-<span class="st"> </span>p <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">data =</span> ribbon.df,
              <span class="kw">aes_string</span>(<span class="dt">x=</span><span class="st">&quot;Times&quot;</span>,<span class="dt">y=</span><span class="kw">paste</span>(<span class="st">&quot;Rep&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;.&quot;</span>)),
              <span class="dt">colour=</span>color_bar[i])
}

<span class="kw">suppressWarnings</span>(p) <span class="co"># to ignore warnings for missing values</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>It very clearly has an oscillitory pattern with a small amount of damping, making echo_find() the perfect function for our dataset.</p>
</div>
<div id="running-echo_find" class="section level2">
<h2>Running echo_find()</h2>
<p>So we begin by assigning our parameters and running the echo_find() function. In this first run, we look for rhythms between 20 and 26 hours, with no preprocessing, assigning these results to a new dataframe.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># echo_find() parameters</span>

genes &lt;-<span class="st"> </span>expressions
begin &lt;-<span class="st"> </span><span class="dv">2</span> <span class="co"># first time point</span>
end &lt;-<span class="st"> </span><span class="dv">48</span> <span class="co"># last time point</span>
resol &lt;-<span class="st"> </span><span class="dv">2</span> <span class="co"># time point resolution</span>
num_reps &lt;-<span class="st"> </span><span class="dv">3</span> <span class="co"># number of replicates</span>
low &lt;-<span class="st"> </span><span class="dv">20</span> <span class="co"># low period seeking</span>
high &lt;-<span class="st"> </span><span class="dv">26</span> <span class="co"># high period seeking</span>
run_all_per &lt;-<span class="st"> </span><span class="ot">FALSE</span> <span class="co"># we are not looking for all periods</span>
paired &lt;-<span class="st"> </span><span class="ot">FALSE</span> <span class="co"># these replicates are unrelated, that is, a replicate being </span>
  <span class="co"># called &quot;replicate 1&quot; at time point 2 means nothing</span>
rem_unexpr &lt;-<span class="st"> </span><span class="ot">FALSE</span> <span class="co"># do not remove unexpressed genes</span>
<span class="co"># we do not assign rem_unexpr_amt, since we're not removing unexpressed genes</span>
is_normal &lt;-<span class="st"> </span><span class="ot">FALSE</span> <span class="co"># do not normalize</span>
is_de_linear_trend &lt;-<span class="st"> </span><span class="ot">FALSE</span> <span class="co"># do not remove linear trends</span>
is_smooth &lt;-<span class="st"> </span><span class="ot">FALSE</span> <span class="co"># do not smooth the data</span>

results &lt;-<span class="st"> </span><span class="kw">echo_find</span>(<span class="dt">genes =</span> genes, <span class="dt">begin =</span> begin, <span class="dt">end =</span> end, <span class="dt">resol =</span> resol, 
  <span class="dt">num_reps =</span> num_reps, <span class="dt">low =</span> low, <span class="dt">high =</span> high, <span class="dt">run_all_per =</span> run_all_per,
  <span class="dt">paired =</span> paired, <span class="dt">rem_unexpr =</span> rem_unexpr, <span class="dt">is_normal =</span> is_normal,
  <span class="dt">is_de_linear_trend =</span> is_de_linear_trend, <span class="dt">is_smooth =</span> is_smooth)

<span class="kw">head</span>(results[,<span class="dv">1</span><span class="op">:</span><span class="dv">16</span>])</code></pre></div>
<pre><code>##   Gene Name Convergence Iterations Amplitude.Change.Coefficient
## 1  Sample 1           1          7                  -0.05319486
## 2  Sample 2           1          7                   0.01320722
## 3  Sample 3           1          6                  -0.07006987
## 4  Sample 4           1         27                  -0.09719734
## 5  Sample 5           1         12                  -0.04007398
## 6  Sample 6           1         24                   0.11423505
##   Oscillation Type Initial.Amplitude Radian.Frequency   Period Phase Shift
## 1           Forced         1.2113583        0.3141593 20.00000  -0.4740203
## 2         Harmonic         0.7143805        0.2749549 22.85170   2.4479327
## 3           Forced         1.6853526        0.2811149 22.35095   3.7599389
## 4           Forced        -0.8353948        0.2416610 26.00000   3.6565164
## 5           Forced         1.4596116        0.3141593 20.00000  -1.6465278
## 6           Damped         0.8879897        0.2416610 26.00000   4.5543195
##   Hours Shifted Equilibrium Value Slope       Tau      P-Value
## 1      1.508853        0.32913648    NA 0.8894112 4.750294e-25
## 2     13.948662        0.12870135    NA 0.9011140 1.138728e-25
## 3      8.975854       -0.09077891    NA 0.9781573 5.940921e-30
## 4     23.869231       -0.04826653    NA 0.7636063 6.955963e-19
## 5      5.241061        0.44750844    NA 0.8989084 6.154595e-26
## 6      7.154096        0.43646180    NA 0.7967642 2.025281e-20
##   BH Adj P-Value BY Adj P-Value
## 1   1.425088e-24   4.422349e-24
## 2   4.554914e-25   1.413486e-24
## 3   7.129105e-29   2.212311e-28
## 4   1.043394e-18   3.237873e-18
## 5   3.692757e-25   1.145940e-24
## 6   3.471911e-20   1.077407e-19</code></pre>
<p>Now we can see that the results data frame has information about the parameters, including forcing coefficient values (whether the oscillation is damped, driven, harmonic, etc.) and p-values. Let’s look at how the fit and parameters turned out for our initial sample. Here we add the fitted values to our plot in black and print the parameters to the console.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># assign the fit to the visualization data frame</span>
ribbon.df<span class="op">$</span>Fit &lt;-<span class="st"> </span><span class="kw">t</span>(results[samp,(<span class="dv">17</span><span class="op">+</span>(<span class="kw">length</span>(tp)<span class="op">*</span>num_reps))<span class="op">:</span><span class="kw">ncol</span>(results)])

<span class="co"># visualize, with shading for each row</span>
<span class="co"># add Fit line</span>
p &lt;-<span class="st"> </span>p <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> ribbon.df,
            <span class="kw">aes_string</span>(<span class="dt">x=</span><span class="st">&quot;Times&quot;</span>,<span class="dt">y=</span><span class="st">&quot;Fit&quot;</span>),
            <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>)

<span class="kw">suppressWarnings</span>(p) <span class="co"># to ignore warnings for missing values</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># print sample's parameters</span>
<span class="kw">cat</span>(<span class="kw">paste0</span>(<span class="st">&quot;Gene Name: &quot;</span>,results<span class="op">$</span><span class="st">`</span><span class="dt">Gene Name</span><span class="st">`</span>[samp],<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,
           <span class="st">&quot;Convergence:&quot;</span>, results<span class="op">$</span>Convergence[samp],<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,
           <span class="st">&quot;Iterations:&quot;</span>,results<span class="op">$</span>Iterations[samp],<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,
           <span class="st">&quot;Forcing Coefficient:&quot;</span>, results<span class="op">$</span>Forcing.Coefficient[samp],<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,
           <span class="st">&quot;Oscillation Type:&quot;</span>,results<span class="op">$</span><span class="st">`</span><span class="dt">Oscillation Type</span><span class="st">`</span>[samp],<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,
           <span class="st">&quot;Amplitude&quot;</span>, results<span class="op">$</span>Amplitude[samp],<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,
           <span class="st">&quot;Radian.Frequency:&quot;</span>,results<span class="op">$</span>Radian.Frequency[samp],<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,
           <span class="st">&quot;Period:&quot;</span>,results<span class="op">$</span>Period[samp],<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,
           <span class="st">&quot;Phase Shift:&quot;</span>,results<span class="op">$</span><span class="st">`</span><span class="dt">Phase Shift</span><span class="st">`</span>[samp],<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,
           <span class="st">&quot;Hours Shifted:&quot;</span>,results<span class="op">$</span><span class="st">`</span><span class="dt">Hours Shifted</span><span class="st">`</span>[samp],<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,
           <span class="st">&quot;P-Value:&quot;</span>,results<span class="op">$</span><span class="st">`</span><span class="dt">P-Value</span><span class="st">`</span>[samp],<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,
           <span class="st">&quot;BH Adj P-Value:&quot;</span>,results<span class="op">$</span><span class="st">`</span><span class="dt">BH Adj P-Value</span><span class="st">`</span>[samp],<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,
           <span class="st">&quot;BY Adj P-Value:&quot;</span>,results<span class="op">$</span><span class="st">`</span><span class="dt">BY Adj P-Value</span><span class="st">`</span>[samp],<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>))</code></pre></div>
<pre><code>## Gene Name: Sample 2
## Convergence:1
## Iterations:7
## Forcing Coefficient:
## Oscillation Type:Harmonic
## Amplitude0.0132072219323617
## Radian.Frequency:0.27495486600141
## Period:22.851697075066
## Phase Shift:2.44793271975246
## Hours Shifted:13.9486623503054
## P-Value:1.13872848886594e-25
## BH Adj P-Value:4.55491395546377e-25
## BY Adj P-Value:1.4134857624926e-24</code></pre>
<p>This fit matches pretty closely to the trend, which is emphasized by the very low adjusted p-value. As we predicted, the oscillation is also damped, which is shown by the positive forcing coefficient and the designation of the oscillation type.</p>
<p>Now let’s see how preprocessing affects the results. Here we search for all possible periods, using the default values for low and high, as well as allowing for all our preprocessing options: removing unexpressed genes, normalizing, removing linear trends, and smoothing.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">run_all_per &lt;-<span class="st"> </span><span class="ot">TRUE</span> <span class="co"># looking for all possible periods</span>
rem_unexpr &lt;-<span class="st"> </span><span class="ot">TRUE</span> <span class="co"># remove unexpressed genes</span>
rem_unexpr_amt &lt;-<span class="st"> </span><span class="dv">70</span> <span class="co"># percentage of unexpressed genes</span>
is_normal &lt;-<span class="st"> </span><span class="ot">TRUE</span> <span class="co"># normalize</span>
is_de_linear_trend &lt;-<span class="st"> </span><span class="ot">TRUE</span> <span class="co"># remove linear trends</span>
is_smooth &lt;-<span class="st"> </span><span class="ot">TRUE</span> <span class="co"># smooth the data</span>

<span class="co"># we're using the default values of low and high, since we're looking for all periods</span>
results &lt;-<span class="st"> </span><span class="kw">echo_find</span>(<span class="dt">genes =</span> genes, <span class="dt">begin =</span> begin, <span class="dt">end =</span> end, <span class="dt">resol =</span> resol, 
  <span class="dt">num_reps =</span> num_reps, <span class="dt">run_all_per =</span> run_all_per, <span class="dt">paired =</span> paired, 
  <span class="dt">rem_unexpr =</span> rem_unexpr, <span class="dt">rem_unexpr_amt =</span> rem_unexpr_amt, <span class="dt">is_normal =</span> is_normal,
  <span class="dt">is_de_linear_trend =</span> is_de_linear_trend, <span class="dt">is_smooth =</span> is_smooth)

<span class="kw">head</span>(results[,<span class="dv">1</span><span class="op">:</span><span class="dv">16</span>])</code></pre></div>
<pre><code>##   Gene Name Convergence Iterations Amplitude.Change.Coefficient
## 1  Sample 1           1          7                  -0.05153645
## 2  Sample 2           1          7                   0.01158215
## 3  Sample 3           1          6                  -0.07416398
## 4  Sample 4           1         10                  -0.07811725
## 5  Sample 5           1         22                  -0.02671812
## 6  Sample 6           1         19                   0.03607861
##   Oscillation Type Initial.Amplitude Radian.Frequency   Period Phase Shift
## 1           Forced         0.6164627        0.3243511 19.37155  -0.6585025
## 2         Harmonic         1.5772231        0.2731879 22.99950   2.5290521
## 3           Forced         0.4877694        0.2788276 22.53430   3.5665380
## 4           Forced         0.4262496        0.2191200 28.67463   0.9115265
## 5         Harmonic         0.9433888        0.3249436 19.33624  10.5812842
## 6           Damped         1.6033760        0.1655006 37.96474   5.9626819
##   Hours Shifted Equilibrium Value        Slope       Tau      P-Value
## 1      2.030215       0.002159052  0.003476106 0.9381728 1.095403e-27
## 2     13.741946       0.095058780  0.005083800 0.9371975 1.240717e-27
## 3      9.743106      -0.217686468 -0.024666260 0.7694577 3.766646e-19
## 4     24.514688       0.110272615 -0.007324020 0.9157424 1.861411e-26
## 5      6.109019      -0.267901060  0.010171317 0.8799940 6.327600e-25
## 6      1.936570      -0.040058335 -0.035910190 0.7245971 3.695378e-17
##   BH Adj P-Value BY Adj P-Value
## 1   4.962868e-27   1.540083e-26
## 2   4.962868e-27   1.540083e-26
## 3   5.022195e-19   1.558493e-18
## 4   5.045212e-26   1.565635e-25
## 5   1.084731e-24   3.366150e-24
## 6   4.031322e-17   1.251004e-16</code></pre>
<p>Since we’ve now searched for all possible periods, periods can now fall outside our predetermined range of 20 to 26 that we set in our first run. Let’s see how this affected the fit and parameters of the sample we looked at.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rep_genes &lt;-<span class="st"> </span>results[samp,<span class="dv">17</span><span class="op">:</span>(<span class="dv">16</span><span class="op">+</span>(<span class="kw">length</span>(tp)<span class="op">*</span>num_reps))]

 <span class="co"># getting min values of replicates</span>
ribbon.df<span class="op">$</span>Min &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="kw">seq</span>(<span class="dv">1</span>,<span class="kw">ncol</span>(rep_genes), <span class="dt">by =</span> num_reps), 
                        <span class="cf">function</span>(x) <span class="kw">min</span>(<span class="kw">unlist</span>(rep_genes[,<span class="kw">c</span>(x<span class="op">:</span>(num_reps<span class="op">-</span><span class="dv">1</span><span class="op">+</span>x))]),
                                        <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))
 <span class="co"># getting max values of replicates</span>
ribbon.df<span class="op">$</span>Max &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="kw">seq</span>(<span class="dv">1</span>,<span class="kw">ncol</span>(rep_genes), <span class="dt">by =</span> num_reps),
                        <span class="cf">function</span>(x) <span class="kw">max</span>(<span class="kw">unlist</span>(rep_genes[,<span class="kw">c</span>(x<span class="op">:</span>(num_reps<span class="op">-</span><span class="dv">1</span><span class="op">+</span>x))]),
                                        <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>num_reps){ <span class="co"># assign each of the replicates</span>
  ribbon.df[,<span class="dv">3</span><span class="op">+</span>i] &lt;-<span class="st"> </span><span class="kw">t</span>(rep_genes[,<span class="kw">seq</span>(i,<span class="kw">ncol</span>(rep_genes),<span class="dt">by=</span>num_reps)])
}
<span class="co"># assign the fit to the visualization data frame</span>
ribbon.df<span class="op">$</span>Fit &lt;-<span class="st"> </span><span class="kw">t</span>(results[samp,(<span class="dv">17</span><span class="op">+</span>(<span class="kw">length</span>(tp)<span class="op">*</span>num_reps))<span class="op">:</span><span class="kw">ncol</span>(results)])

<span class="co"># visualize, with shading for each row</span>
p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> ribbon.df,<span class="kw">aes</span>(<span class="dt">x=</span>Times))<span class="op">+</span><span class="st"> </span><span class="co"># declare the dataframe and main variables</span>
<span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Times, <span class="dt">ymax=</span>Max, <span class="dt">ymin=</span>Min, <span class="dt">colour=</span><span class="st">&quot;Original&quot;</span>),
              <span class="dt">fill =</span> <span class="st">&quot;gray&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>)<span class="op">+</span><span class="st"> </span><span class="co"># create shading</span>
<span class="st">  </span><span class="kw">ggtitle</span>(expressions[samp,<span class="dv">1</span>])<span class="op">+</span><span class="st"> </span><span class="co"># gene name is title</span>
<span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="st">&quot;&quot;</span>,<span class="dt">values=</span>color_bar)<span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="st">&quot;&quot;</span>,<span class="dt">values=</span>color_bar)<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> .<span class="dv">5</span>),
        <span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,<span class="dt">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Hours&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Expression&quot;</span>) <span class="co">#Label for axes</span>
<span class="co"># add specific replicate lines </span>
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>num_reps){
  p &lt;-<span class="st"> </span>p <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">data =</span> ribbon.df,
              <span class="kw">aes_string</span>(<span class="dt">x=</span><span class="st">&quot;Times&quot;</span>,<span class="dt">y=</span><span class="kw">paste</span>(<span class="st">&quot;Rep&quot;</span>,i,<span class="dt">sep =</span> <span class="st">&quot;.&quot;</span>)),
              <span class="dt">colour=</span>color_bar[i])
}

<span class="co"># add Fit line</span>
p &lt;-<span class="st"> </span>p <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> ribbon.df,
            <span class="kw">aes_string</span>(<span class="dt">x=</span><span class="st">&quot;Times&quot;</span>,<span class="dt">y=</span><span class="st">&quot;Fit&quot;</span>),
            <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>)

<span class="kw">suppressWarnings</span>(p) <span class="co"># to ignore warnings for missing values</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># print sample's parameters</span>
<span class="kw">cat</span>(<span class="kw">paste0</span>(<span class="st">&quot;Gene Name: &quot;</span>,results<span class="op">$</span><span class="st">`</span><span class="dt">Gene Name</span><span class="st">`</span>[samp],<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,
           <span class="st">&quot;Convergence:&quot;</span>, results<span class="op">$</span>Convergence[samp],<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,
           <span class="st">&quot;Iterations:&quot;</span>,results<span class="op">$</span>Iterations[samp],<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,
           <span class="st">&quot;Forcing Coefficient:&quot;</span>, results<span class="op">$</span>Forcing.Coefficient[samp],<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,
           <span class="st">&quot;Oscillation Type:&quot;</span>,results<span class="op">$</span><span class="st">`</span><span class="dt">Oscillation Type</span><span class="st">`</span>[samp],<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,
           <span class="st">&quot;Amplitude&quot;</span>, results<span class="op">$</span>Amplitude[samp],<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,
           <span class="st">&quot;Radian.Frequency:&quot;</span>,results<span class="op">$</span>Radian.Frequency[samp],<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,
           <span class="st">&quot;Period:&quot;</span>,results<span class="op">$</span>Period[samp],<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,
           <span class="st">&quot;Phase Shift:&quot;</span>,results<span class="op">$</span><span class="st">`</span><span class="dt">Phase Shift</span><span class="st">`</span>[samp],<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,
           <span class="st">&quot;Hours Shifted:&quot;</span>,results<span class="op">$</span><span class="st">`</span><span class="dt">Hours Shifted</span><span class="st">`</span>[samp],<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,
           <span class="st">&quot;P-Value:&quot;</span>,results<span class="op">$</span><span class="st">`</span><span class="dt">P-Value</span><span class="st">`</span>[samp],<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,
           <span class="st">&quot;BH Adj P-Value:&quot;</span>,results<span class="op">$</span><span class="st">`</span><span class="dt">BH Adj P-Value</span><span class="st">`</span>[samp],<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,
           <span class="st">&quot;BY Adj P-Value:&quot;</span>,results<span class="op">$</span><span class="st">`</span><span class="dt">BY Adj P-Value</span><span class="st">`</span>[samp],<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>))</code></pre></div>
<pre><code>## Gene Name: Sample 2
## Convergence:1
## Iterations:7
## Forcing Coefficient:
## Oscillation Type:Harmonic
## Amplitude0.0115821511350654
## Radian.Frequency:0.273187879811216
## Period:22.9995024359116
## Phase Shift:2.52905209959498
## Hours Shifted:13.7419464222895
## P-Value:1.24071709814817e-27
## BH Adj P-Value:4.9628683925927e-27
## BY Adj P-Value:1.54008261904479e-26</code></pre>
<p>We can see that the fit hasn’t changed very much, but that the smoothing has gotten the replicates much closer to each other. This smoothing has also reduced the amount of damping in the system: the forcing coefficient has decreased by about .002.</p>
<p>Other selections are also available. Confidence interval calculations with either bootstrapping or jackknifing with a set random seed for reproducibility are also available through the run_conf, which_conf, and seed options respectively. However, it is important to note that this will increase the time length of runs. Further, adjustments for the harmonic and overexpressed cutoffs can be adjusted through the harm_cut and over_cut parameters, respectively, though the defaults are recommended.</p>
<p>Now that you understand the basics of using the echo_find() function, feel free to experiment and play around with this vignette and the example data. Good luck with your rhythm searches!</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
